var He=Object.defineProperty,ze=Object.defineProperties;var Je=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var De=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var Ae=(e,o,s)=>o in e?He(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,w=(e,o)=>{for(var s in o||(o={}))De.call(o,s)&&Ae(e,s,o[s]);if(ce)for(var s of ce(o))Ee.call(o,s)&&Ae(e,s,o[s]);return e},S=(e,o)=>ze(e,Je(o));var ue=(e,o)=>{var s={};for(var a in e)De.call(e,a)&&o.indexOf(a)<0&&(s[a]=e[a]);if(e!=null&&ce)for(var a of ce(e))o.indexOf(a)<0&&Ee.call(e,a)&&(s[a]=e[a]);return s};import{j as t,a as m,R as Ve,b as Ke,r as g,u as be,t as p,c as ye,A as We,d as q,e as _,f as Qe,g as Ye,h as Ze,i as Xe,k as et,l as tt,F as G,L as pe,m as ve,n as st,o as at,Q as re,C as ot,p as nt,q as rt,s as it,B as lt,v as ct,w as ut,x as dt,y as ie,W as Y,P as Oe,z as pt,D as mt,E as ht,G as gt,H as ft,N as xt,S as Te,T as bt,I as yt,J as U,K as vt,M as Ct}from"./vendor.0b8d74d3.js";const wt=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const l of n)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&a(i)}).observe(document,{childList:!0,subtree:!0});function s(n){const l={};return n.integrity&&(l.integrity=n.integrity),n.referrerpolicy&&(l.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?l.credentials="include":n.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(n){if(n.ep)return;n.ep=!0;const l=s(n);fetch(n.href,l)}};wt();const T=(e,o)=>parseFloat(Math.round(e*Math.pow(10,o))/Math.pow(10,o)).toFixed(o),Nt=({data:e})=>{const{label:o,period:s,total:a,previousTotal:n,previousPeriod:l}=e,i=a-n;return t("div",{className:"shadow-lg bg-white rounded-lg border w-full my-2 md:my-0",children:t("div",{className:"m-4 uppercase font-mono",children:m("div",{className:"flex gap-2 justify-between",children:[m("div",{className:"flex flex-col",children:[t("p",{className:" font-semibold text-gray-500 text-sm",children:o}),m("div",{className:"flex flex-row",children:[i>0?t(Ve,{className:"mt-1 text-green-600"}):t(Ke,{className:"mt-1 text-red-600"}),m("p",{className:"text-xl font-bold",children:["$",a]})]})]}),m("div",{className:"flex flex-col gap-2",children:[m("p",{className:"self-center",children:["$",T(n,2)]}),t("p",{className:"text-xs text-gray-500",children:l})]})]})})})};function R(e){let o=new Date(e),s=""+(o.getMonth()+1),a=""+o.getDate(),n=o.getFullYear();return s.length<2&&(s="0"+s),a.length<2&&(a="0"+a),[n,s,a].join("-")}const j="https://api.svtechpos.com",Ie=j+"/proveedores/",fe=j+"/compras/",xe=j+"/gastos/",St=j+"/token/",At=j+"/states/",Ue=j+"/companies/",de=j+"/users/",Dt=j+"/summary/",Et=j+"/users/changepassword/",Ot=j+"/users/appcredential/",Tt=j+"/compras/reporte/",P=()=>{const[e,o]=g.exports.useState(null),[s,a]=g.exports.useState(null),n=be();return g.exports.useEffect(()=>{let i=window.localStorage.getItem("user"),d=window.localStorage.getItem("uuid");if(i&&d){i=JSON.parse(i);const u=new Date().getTime();if(new Date(i.expire+"Z").getTime()-u<6e4)return window.localStorage.removeItem("user"),window.localStorage.removeItem("uuid"),p.error("Sesi\xF3n expirada, vuelve a iniciar sesi\xF3n para continuar"),n("/login",{replace:!0});o(i),a(d)}if(!i)return window.localStorage.removeItem("user"),window.localStorage.removeItem("uuid"),p.error("Sesi\xF3n expirada, vuelve a iniciar sesi\xF3n para continuar"),n("/login",{replace:!0})},[]),[e,s,i=>{if(i===401)return window.localStorage.removeItem("user"),window.localStorage.removeItem("uuid"),p.error("La sesi\xF3n ha expirado"),n("/login",{replace:!0})}]},ke=(e,o)=>`${Dt}?start=${e}&finish=${o}`,It={summary:[],bytype:{},byhour:{},bytypeporc:{},bypayment:[],byitem:[]},kt=()=>{const[e,o]=g.exports.useState(It),[s,a,n]=P(),l={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};return g.exports.useEffect(()=>{if(s){const d=p.loading("Cargando");let u=R(Date.now());fetch(ke(u,u),l).then(c=>(n(c.status),c.json())).then(c=>o(c)).then(()=>p.remove(d))}},[s]),[e,async({start:d,finish:u})=>{if(!u||!d)return p.error("Seleccionar rango de fechas",{id:"rangeDate"});const c=p.loading("Cargando"),h=R(d),r=R(u),b=await fetch(ke(h,r),l);n(b.status);const v=await b.json();o(v),p.remove(c)}]},Rt=(e,o)=>`${fe}?start=${e}&finish=${o}`,Ce=()=>{const[e,o]=g.exports.useState([]),[s,a,n]=P(),[l,i]=g.exports.useState({doc:[],type:[]}),[d,u]=g.exports.useState(e),[c,h]=g.exports.useState({doc:[],type:[]}),r=async({start:x,end:N})=>{const A=R(x),D=R(N),f={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};try{const E=p.loading("Cargando...",{id:"loading"}),I=await fetch(Rt(A,D),f);n(I.status);const F=await I.json();p.dismiss(E),o(F)}catch(E){p.dismiss(),p.error("Error al obtener registros: "+E)}};return g.exports.useEffect(()=>{s&&r({start:Date.now(),end:Date.now()})},[s]),g.exports.useEffect(()=>{let x=[],N=[];u(e),e.map(f=>{x.indexOf(f.documento.value)===-1&&x.push(f.documento),N.indexOf(f.tipo.value)===-1&&N.push(f.tipo)});let A=[...new Set(N)],D=[...new Set(x)];N.length=0,x.length=0,A.map(f=>{N.push({value:f,label:f})}),D.map(f=>{x.push({value:f,label:f})}),i(S(w({},l),{doc:x,type:N}))},[e]),g.exports.useEffect(()=>{console.log(c);let x=e.filter(N=>{for(let A of c.doc)if(N.documento===A)return!0;for(let A of c.type)if(N.tipo===A)return!0;if(c.doc.length===0&&c.type.length===0)return!0});u(x),console.log(x)},[c]),{addPurchases:async({data:x,action:N})=>{if(x.length>0){const A={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a},body:JSON.stringify(x)};try{const D=p.loading("Guardando compras...",{id:"addingPurchases"}),f=await fetch(fe,A);n(f.status);const E=await f.json();p.dismiss(D),E>0&&(p.success("Compras guardadas",{id:"purchases"}),N([]),localStorage.setItem("compras",JSON.stringify([])))}catch(D){p.dismiss(),p.error("Error al guardar compras: "+D,{id:"purchasesError"})}}else p.error("No hay compras que guardar",{id:"purchasesError"})},purchases:e,getPurchases:r,deletePurchase:async({id:x})=>{let N=fe+"?comprasId="+x;const A={method:"DELETE",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"DELETE",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};try{const D=p.loading("Borrando...",{id:"deleting"}),f=await fetch(N,A);n(f.status);const E=await f.json();p.dismiss(D),E>0&&p.success("Registro eliminado",{id:"deleted"})}catch(D){p.dismiss(),p.error("Error al eliminar registro: "+D)}},filters:l,filterData:(x,N)=>{console.log(x);let A=[],D=[];N==="doc"&&(x.length===0&&h(S(w({},c),{doc:[]})),x.map(f=>{A.push(f.value),h(S(w({},c),{doc:A}))})),N==="type"&&(x.length===0&&h(S(w({},c),{type:[]})),x.map(f=>{D.push(f.value),h(S(w({},c),{type:D}))}))},filteredData:d}},Ft=({initialData:e,showHeader:o=null})=>{const[s,a]=g.exports.useState([]),n=l=>{for(const[i,d]of l.entries())if(i===0)return Object.keys(d)};return g.exports.useEffect(()=>{if(o)return a(o);let l=n(e);a(l)},[]),g.exports.useEffect(()=>{if(o)return a(o);let l=n(e);a(l)},[e]),[s]},B=({data:e=[],title:o="",square:s=!0,showHeader:a=null,columnsToShow:n=[],withMaxHeight:l=!1,setRows:i,activateActions:d=!1,buttons:u=[],heigth:c="h-full"})=>{const[h]=Ft({initialData:e,showHeader:a});return t("div",{className:` m-2 bg-white ${l?"h-full":`aspect-square ${s?"md:aspect-square":"md:aspect-[2/1]"}`}`,children:m("div",{className:`flex flex-col shadow-lg rounded-lg  border ${c}`,children:[t("header",{className:"px-5 py-4 border-b border-gray-100",children:t("p",{className:"font-bold text-gray-600 text-xs text-center",children:o})}),t("div",{className:"p-3 overflow-y-auto overflow-x-auto h-full",children:e.length>0?m("table",{className:"table-auto w-full ",children:[t("thead",{className:" text-sm font-semibold uppercase text-gray-500 bg-gray-50",children:t("tr",{className:"font-mono",children:h==null?void 0:h.map(r=>t("th",{className:"p-2 whitespace-nowrap text-center",children:r},r))})}),t("tbody",{className:"text-sm divide-y divide-gray-100",children:e==null?void 0:e.map((r,b)=>m("tr",{children:[Object.values(r).map((v,y)=>{if(n.length>0?n.includes(Object.keys(r)[y]):[])return t("td",{className:`p-2 whitespace-nowrap ${isNaN(v)?"text-left":"text-center"}`,children:v},y)}),t("td",{children:u.map(v=>v(r,b,r==null?void 0:r.id))},r.id)]},b))})]}):t("div",{className:"flex justify-center items-center h-full",children:t("p",{className:"",children:"Sin datos"})})})]})})};function jt(e,o){const s=u=>Math.min(Math.max(u,0),255),a=u=>("00"+u).slice(-2),n=parseInt(e.substr(1),16),l=s((n>>16)+o),i=s((n>>8&255)+o),d=s((n&255)+o);return"#"+a(l.toString(16))+a(i.toString(16))+a(d.toString(16))}const he=({data:e={},dataLabel:o="",singleColor:s=!1})=>{let a={};const n=Object.keys(e),l=Object.values(e);let i=1,d=["#2196F3"];if(!s){d.length=0;for(let c of l)d.push(jt("#2196F3",i*12)),i++}let u=[{label:o,data:l,backgroundColor:d}];return a.labels=n,a.datasets=u,a.colors=[],a};const Z=ye.forwardRef((s,o)=>{var e=ue(s,[]);return m("div",{className:"input-container",children:[t("input",S(w({type:"text",className:"rounded-sm border bg-sky-400"},e),{ref:o,readOnly:!0})),t("label",{className:"filled",children:e.labeltext})]})});const le=({onClick:e})=>t("div",{className:"icon-container",onClick:e,children:t("button",{children:t("svg",{className:"svg-icon",viewBox:"0 0 20 20",children:t("path",{fill:"none",d:"M3.254,6.572c0.008,0.072,0.048,0.123,0.082,0.187c0.036,0.07,0.06,0.137,0.12,0.187C3.47,6.957,3.47,6.978,3.484,6.988c0.048,0.034,0.108,0.018,0.162,0.035c0.057,0.019,0.1,0.066,0.164,0.066c0.004,0,0.01,0,0.015,0l2.934-0.074c0.317-0.007,0.568-0.271,0.56-0.589C7.311,6.113,7.055,5.865,6.744,5.865c-0.005,0-0.01,0-0.015,0L5.074,5.907c2.146-2.118,5.604-2.634,7.971-1.007c2.775,1.912,3.48,5.726,1.57,8.501c-1.912,2.781-5.729,3.486-8.507,1.572c-0.259-0.18-0.618-0.119-0.799,0.146c-0.18,0.262-0.114,0.621,0.148,0.801c1.254,0.863,2.687,1.279,4.106,1.279c2.313,0,4.591-1.1,6.001-3.146c2.268-3.297,1.432-7.829-1.867-10.101c-2.781-1.913-6.816-1.36-9.351,1.058L4.309,3.567C4.303,3.252,4.036,3.069,3.72,3.007C3.402,3.015,3.151,3.279,3.16,3.597l0.075,2.932C3.234,6.547,3.251,6.556,3.254,6.572z"})})})}),Pt=[{title:"Dashboard",path:"/",icon:t(We,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:null},{title:"Compras",path:"/compras",icon:t(Qe,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:null},{title:"Usuarios",path:"/usuarios",icon:t(Ye,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:null},{title:"Gastos",path:"/gastos",icon:t(Ze,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:null},{title:"Ajustes",path:"/ajustes",icon:t(Xe,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:null},{title:"Reportes",path:"#",icon:t(et,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:[{title:"Ganancias/p\xE9rdidas",path:"/reporte/ganancias",icon:null},{title:"Compras",path:"/reporte/compras",icon:null}],action:null},{title:"Cerrar sesi\xF3n",path:"/login",icon:t(tt,{}),iconClosed:t(q,{}),iconOpened:t(_,{}),subNav:null,action:()=>{window.localStorage.removeItem("user"),window.localStorage.removeItem("uuid")}}],qe=({color:e,height:o=.5,opacity:s=.5,margin:a="10px 0px 10px 0px"})=>t("hr",{style:{color:e,backgroundColor:e,height:o,borderColor:e,opacity:s,margin:a}}),Mt=({item:e,path:o,index:s})=>m(G,{children:[s===0?null:t(qe,{color:"DimGray",opacity:"0.2"}),t(pe,{to:e.path,className:`flex justify-start items-center mt-2 p-5 list-none h-6 text-base hover:bg-blue-600 border-l-4 border-transparent rounded-lg ${o===e.path?"bg-blue-600":null}`,children:t("div",{className:"ml-8",children:e.title})})]}),Lt=({item:e,index:o})=>{const[s,a]=g.exports.useState(!1),n=()=>a(!s);let l=ve().pathname;return m(G,{children:[o===0?null:t(qe,{color:"DimGray",opacity:"0.2"}),m("div",{className:"px-2 py-1",children:[m(pe,{to:e.path,onClick:e.action?e.action:e.subNav&&n,className:`relative flex justify-start items-center p-5 list-none h-8 text-base hover:bg-blue-600 border-l-4 border-transparent hover: rounded-lg ${l===e.path?" bg-blue-600":null}`,children:[t("div",{className:"text-white mr-2",children:e.icon}),t("span",{className:"ml-2",children:e.title}),t("span",{className:"absolute right-8",children:e.subNav&&s?e.iconOpened:e.subNav?e.iconClosed:null})]}),s&&e.subNav.map((i,d)=>t(Mt,{item:i,index:d,path:l},i.title))]})]})},X=()=>{const[e,o]=g.exports.useState(!1),s=()=>o(!e);return m(G,{children:[t("div",{className:"absolute w-full bg-gray-900 h-12 flex justify-start items-center lg:-top-full lg:-mt-12",children:t(pe,{onClick:s,className:"ml-4 my-8  h-8 w-8",to:"#",children:t(st,{className:"text-3xl h-8 flex justify-start items-center text-white"})})}),t("nav",{className:`fixed transition-all z-10 bg-gray-900 w-60 h-full  flex  top-0 ${e?"left-0":"-left-full"}  overflow-y-auto lg:left-0`,children:m("div",{className:"w-full text-white",children:[t(pe,{to:"#",className:"text-white lg:invisible",children:t(at,{onClick:s,className:"absolute text-3xl h-8 mt-2 mb-2 right-2 text-white"})}),t("div",{className:"mt-12",children:Pt.map((a,n)=>t(Lt,{item:a,index:n},n))})]})})]})};re("es",ie);ot.register(nt,rt,it,lt,ct,ut,dt);const ge="shadow-lg rounded-lg m-2 border bg-white",Ut=()=>{var u;const[e,o]=kt(),[s,a]=g.exports.useState([new Date,new Date]),[n,l]=s,i=ye.useRef();console.log(e==null?void 0:e.bytype);const d=({title:c,maintainAspectRatio:h=!0})=>({responsive:!0,maintainAspectRatio:h,layout:{padding:20},plugins:{legend:{position:"top"},title:{display:!0,text:c}}});return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),m("div",{className:"w-full lg:ml-60",children:[m("div",{className:"relative flex justify-end mr-2 mt-12 lg:mt-0",children:[t("div",{className:"w-58",children:t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:i,labeltext:"Fecha"}),selectsRange:!0,peekNextMonth:!0,showMonthDropdown:!0,useShortMonthInDropdown:!0,startDate:n,endDate:l,onChange:c=>{a(c)}})}),t(le,{onClick:()=>o({start:n,finish:l})})]}),t("div",{className:" m-2 gap-2 md:grid grid-cols-2 lg:flex ",children:(u=e==null?void 0:e.summary)==null?void 0:u.map(c=>t(Nt,{data:c},c.label))}),m("div",{className:"md:grid grid-cols-3",children:[m("div",{className:"relative w-full",children:[Object.keys(e==null?void 0:e.bytype).length===0?t("p",{className:"absolute top-1/2 text-center w-full",children:"Sin datos"}):null,t(Oe,{className:ge,options:d({title:"VENTAS POR TIPO EN %"}),data:he({data:e==null?void 0:e.bytypeporc,dataLabel:"Por hora"})})]}),t("div",{className:"relative w-full",children:t(B,{data:e==null?void 0:e.bypayment,title:"DETALLE DE PAGOS"})}),m("div",{className:"relative w-full",children:[Object.keys(e==null?void 0:e.bytype).length===0?t("p",{className:"absolute top-1/2 text-center w-full",children:"Sin datos"}):null,t(Oe,{className:ge,options:d({title:"VENTAS POR TIPO"}),data:he({data:e==null?void 0:e.bytype,dataLabel:"Por hora"})})]})]}),m("div",{className:"md:grid grid-cols-2",children:[t("div",{className:"relative w-full",children:t(pt,{className:ge,options:d({title:"VENTAS POR HORA"}),data:he({data:e==null?void 0:e.byhour,dataLabel:"Por hora",singleColor:!0})})}),t("div",{className:"relative w-full",children:t(B,{data:e==null?void 0:e.byitem,square:!1,title:"DETALLE DE PRODUCTOS"})})]})]})]})},_e=()=>{const[e,o]=g.exports.useState(null),[s,a]=g.exports.useState("loading"),n=be();return g.exports.useEffect(()=>{let i=JSON.parse(window.localStorage.getItem("user"));if(i){const d=new Date(i.expire+"Z").getTime(),u=new Date().getTime();if(d-u<6e4)return window.localStorage.removeItem("user"),window.localStorage.removeItem("uuid"),p.error("Sesi\xF3n expirada, vuelve a iniciar sesi\xF3n para continuar"),n("/login",{replace:!0});o(i)}a("loaded")},[]),{user:e,authUser:async({formData:i})=>{const d=new URLSearchParams;d.append("username",i.username),d.append("password",i.password);const u={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:d};try{a("loging");const c=await fetch(St,u);if(c.status===200){const h=await c.json();return o(h),window.localStorage.setItem("user",JSON.stringify(h)),window.localStorage.setItem("uuid",h.companies[0].uuid),a("loaded"),h}c.status===401&&p.error("Contrase\xF1a o usuario no v\xE1lido",{id:"invalidLogin"}),a("loaded")}catch{return a("loaded"),p.error("Error al iniciar sesi\xF3n",{id:"erroAtLogin"}),null}},state:s}},qt=()=>{var h;const{authUser:e,state:o}=_e(),s=be(),n=((h=ve().state)==null?void 0:h.from)||"/",[l,i]=g.exports.useState({username:"",password:"",keepsession:!1}),d={loging:t(mt,{className:"animate-spin absolute right-2 top-1 w-8 h-8"}),loaded:t(ht,{className:`absolute right-2 top-1 w-8 h-8 
                    ${l.password&&l.username!==""?"text-gray-500":"text-gray-300"}`})},u=r=>{i(S(w({},l),{[r.target.name]:r.target.type==="checkbox"?r.target.checked:r.target.value}))};return t("div",{className:"h-screen w-screen flex bg-blue-200 bg-opacity-10",children:m("div",{className:"flex flex-col items-center justify-center w-full",children:[t("h1",{className:"m-6",children:"Iniciar sesi\xF3n en TechPOS"}),t("form",{onSubmit:async r=>{r.preventDefault(),await e({formData:l})&&s(n,{replace:!0})},children:m("div",{className:"flex flex-col",children:[t("input",{className:"h-10 w-80 rounded-t-md pl-2 border shadow-sm outline-blue-600",type:"text",autoComplete:"off",autoCorrect:"off",autoCapitalize:"off",required:!0,placeholder:"Cuenta de sesi\xF3n",name:"username",value:l.username,onChange:u}),m("div",{className:"relative h-10 w-80",children:[t("button",{disabled:!(l.password||l.username!==""),children:d[o]}),t("input",{className:"w-full h-full rounded-b-md pl-2 border shadow-sm outline-blue-600",type:"password",autoComplete:"off",required:!0,placeholder:"Contrase\xF1a",value:l.password,name:"password",onChange:u})]}),t("div",{className:"flex items-center justify-center gap-2 m-6",children:m("label",{children:[t("input",{className:"w-4 h-4 relative top-0.5 right-1",type:"checkbox",name:"keepsession",onChange:u,checked:l.keepsession}),"Permanecer conectado"]})})]})})]})})};const C=o=>{var e=ue(o,[]);return!e.hidden&&m("div",{className:"input-container",children:[t("input",w({},e)),t("label",{hidden:e.hidden,className:"filled",children:e.labeltext})]})},k=o=>{var e=ue(o,[]);return!e.hidden&&m("div",{className:"select-container",children:[m("select",S(w({},e),{children:[t("option",{value:"",disabled:!0,children:"Elige una opci\xF3n"}),Array.isArray(e.data)?e.data.map(s=>t("option",{className:"option",value:s,children:s},s)):e.fromKeys?Object.values(e.data).map(s=>t("option",{className:"option",value:s,children:s},s)):Object.keys(e.data).map(s=>t("option",{className:"option",value:s,children:s},s))]})),t("label",{hidden:e.hidden,className:"filled",children:e.labeltext})]})},_t=({children:e,title:o,hidden:s})=>{const[a,n]=g.exports.useState(!1);return m("div",{hidden:s,className:"p-2shadow-sm border rounded-md border-[#37aaf7]",children:[m("div",{className:"p-3 border-bottom flex justify-content-between",children:[t("h6",{className:"text-sm text-[#6f81a5]",children:o}),t("button",{type:"button",className:"text-[#6f81a5]",onClick:()=>{n(i=>!i)},children:a?t(_,{}):t(q,{})})]}),t("div",{className:"border-bottom",children:t("div",{children:a&&t("div",{className:"p-3",children:e})})})]})},ae=({children:e,title:o,isOpen:s,handleClosingDialog:a,fullScreen:n=!1})=>s&&t("div",{className:"fixed bg-gray-800/50  h-full w-full z-10 flex justify-center items-center",children:m("div",{className:`${n?"h-full":"max-w-md  mx-4 rounded-lg"} w-full z-30 border bg-white opacity-100 shadow-md p-4`,children:[m("div",{className:"flex justify-between p-0.5",children:[t("h3",{className:"px-2 font-semibold",children:o}),t("button",{onClick:a,children:t(gt,{className:" text-red-600 w-6 h-6 relative -right-2 -top-3"})})]}),e]})}),Gt=()=>{const[e,o]=g.exports.useState([]),[s,a,n]=P();return g.exports.useEffect(()=>{if(s){const i={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};fetch(Ie,i).then(d=>(n(d.status),d.json())).then(d=>o(d))}},[s]),[e,async({nrc:i,supplierName:d,actions:u})=>{const c=new Date().toISOString(),h={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a},body:JSON.stringify([{nombre:d,nrc:i,guardado:c,id:0}])};try{const r=await fetch(Ie,h);n(r.status),r.status===200&&(o(b=>[...b,{nombre:d,nrc:i,guardado:c,id:0}]),u.setFormData(b=>S(w({},b),{supplier:d,supplierName:""})),u.isOpen(b=>!b))}catch(r){u.setFormData(b=>S(w({},b),{supplier:""})),p.error("Error al agregar proveedor: "+r,{id:"SuppError"})}}]};re("es",ie);const Bt=["Fecha","Documento","Tipo","Descripci\xF3n/Referencia","NRC","Proveedor","Total","IVA","DUI","Compras internas exentas","Internaciones exentas y/o no sujetas","importaciones exentas y/o no sujetas","Internaciones gravadas de bienes","Importaciones gravadas de bienes","Importaciones gravadas de servicios","Acciones"],$t=["fecha","documento","tipo","referencia","nrc","nombre","compra","iva","dui","comInEx","intExNoSuj","imExNoSuj","inGraBie","imGravBie","imGravSer"],Ht=()=>{const{purchases:e,getPurchases:o,deletePurchase:s}=Ce(),[a,n]=g.exports.useState([new Date,new Date]),[l,i]=a,d=g.exports.useRef(),u=async c=>{await s({id:c}),await o({start:l,end:i})};return m("div",{className:"flex flex-col h-full",children:[m("div",{className:"relative flex justify-end mr-2",children:[t("div",{className:"w-60",children:t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:d,labeltext:"Fecha"}),selectsRange:!0,peekNextMonth:!0,showMonthDropdown:!0,useShortMonthInDropdown:!0,startDate:l,endDate:i,onChange:c=>{n(c)}})}),t(le,{onClick:()=>o({start:l,end:i})})]}),t("div",{className:"max-h-[85%]",children:t(B,{title:"Lista de compras",square:!1,data:e,showHeader:Bt,withMaxHeight:!0,columnsToShow:$t,activateActions:!0,buttons:[(c,h,r)=>t("button",{className:"button-warning",onClick:()=>u(r),children:"Borrar"},r)]})})]})},Re={"Consumidor Final":0,"Cr\xE9dito Fiscal":3,"Nota de Cr\xE9dito":5,"Nota de D\xE9bito":6,"Factura de Exportaci\xF3n":11,"Declaraci\xF3n de Mercanc\xEDa":12,"Mandamiento de Ingreso":13},Fe={"Impreso por imprenta o tiquetes":1,"Formulario \xFAnico":2,Otro:3,"Documento tributario electronico (DTE)":4},zt={"NRC/NIT":0,DUI:1},je={docType:"Consumidor Final",docCategorie:"Impreso por imprenta o tiquetes",description:"",nrc:"",supplier:"",compra:"",iva:"",dui:"",comInEx:0,intExNoSuj:0,imExNoSuj:0,inGraBie:0,imGravBie:0,imGravSer:0,duinit:"NRC/NIT",supplierName:""},Jt=["Fecha","Documento","Tipo","Descripci\xF3n/Referencia","NRC","Proveedor","Total","IVA","DUI","Compras internas exentas","Internaciones exentas y/o no sujetas","importaciones exentas y/o no sujetas","Internaciones gravadas de bienes","Importaciones gravadas de bienes","Importaciones gravadas de servicios","Acci\xF3n"],Vt=["fecha","documento","tipo","referencia","nrc","nombre","compra","iva","dui","comInEx","intExNoSuj","imExNoSuj","inGraBie","imGravBie","imGravSer"],Kt=()=>{var D;const[e,o]=Gt(),{addPurchases:s}=Ce(),[a,n]=g.exports.useState(je),[l,i]=g.exports.useState(new Date),[d,u]=g.exports.useState(!1),[c,h]=g.exports.useState(!1),[r,b]=g.exports.useState(JSON.parse((D=localStorage.getItem("compras"))!=null?D:"[]")),v=g.exports.useRef(),y=()=>{u(f=>!f)},x=f=>{var E;if(n(I=>S(w({},I),{[f.target.name]:f.target.value})),f.target.name==="nrc"){const F=(E=e.filter(M=>f.target.value===M.nrc)[0])==null?void 0:E.nombre;if(F)return n(M=>S(w({},M),{supplier:F}));n(M=>S(w({},M),{supplier:""}))}if(f.target.name==="duinit")return n(I=>S(w({},I),{[f.target.name]:f.target.value,dui:"",nrc:""}));if(f.target.name==="docType")return n(()=>S(w({},je),{[f.target.name]:f.target.value}));if(f.target.name==="compra")return n(I=>S(w({},I),{[f.target.name]:f.target.value,iva:T(f.target.value-f.target.value/1.13,2)}))},N=f=>{f.preventDefault();const{docType:E,docCategorie:I,description:F,nrc:M,supplier:oe,compra:ne,iva:L,dui:$,comInEx:H,intExNoSuj:z,imExNoSuj:J,inGraBie:V,imGravBie:K,imGravSer:W,duinit:ee,supplierName:me}=a;if(E!=="Consumidor Final"&&oe==="")return p.error("Registra proveedor antes",{id:"noSupplier"});let te={id:0,fecha:R(l),documento:E,documentoId:Re[E],tipo:I,tipoId:Fe[I],referencia:F,nrc:M,nombre:oe,compra:ne,iva:L,dui:$,comInGra:T(ne-L,2),comInEx:H,intExNoSuj:z,imExNoSuj:J,inGraBie:V,imGravBie:K,imGravSer:W,attachmentId:3,guardado:new Date().toISOString()};console.log(te),b(se=>[...se,te]),localStorage.setItem("compras",JSON.stringify([...r,te])),n(se=>S(w({},se),{compra:"",iva:""}))},A=f=>{const E=r.filter((I,F)=>F!==f);b(E),localStorage.setItem("compras",JSON.stringify(E))};return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),t(ae,{title:"Agregar proveedor",handleClosingDialog:y,isOpen:d,children:m("div",{className:"flex flex-col",children:[a.duinit==="DUI"?t(C,{required:!0,labeltext:"DUI",value:a.dui,type:"text",name:"dui",autoComplete:"off",readOnly:!0,onChange:x}):t(C,{required:!0,labeltext:"NIT o NRC",value:a.nrc,type:"text",name:"nrc",autoComplete:"off",readOnly:!0,onChange:x}),t(C,{required:!0,labeltext:"Nombre o raz\xF3n social",value:a.supplierName,type:"text",name:"supplierName",autoComplete:"off",onChange:x}),t("button",{type:"button",className:"button",onClick:()=>o({nrc:a.nrc,supplierName:a.supplierName,actions:{isOpen:u,setFormData:n}}),children:"Guardar"})]})}),t(ae,{fullScreen:!0,isOpen:c,handleClosingDialog:()=>h(f=>!f),children:t(Ht,{})}),t("div",{className:"w-full lg:pl-60",children:m("div",{className:"relative flex flex-col mx-2 mt-12 lg:mt-0",children:[m("form",{className:"m-2",onSubmit:N,children:[t(k,{labeltext:"Documento",value:a.docType,name:"docType",onChange:x,data:Re}),t(k,{labeltext:"Tipo",value:a.docCategorie,name:"docCategorie",onChange:x,data:Fe}),m("div",{className:"md:flex md:gap-2",children:[t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:v,labeltext:"Fecha"}),selected:l,peekNextMonth:!0,useShortMonthInDropdown:!0,onChange:f=>{i(f)}}),t(C,{required:!0,labeltext:a.docType!=="Consumidor Final"?"N\xFAmero de documento":"Descripci\xF3n",value:a.description,type:a.docType!=="Consumidor Final"?"number":"text",name:"description",autoComplete:"off",onChange:x})]}),t(k,{labeltext:"Documento tributario",hidden:a.docType==="Consumidor Final",value:a.duinit,name:"duinit",onChange:x,data:zt}),m("div",{className:`${a.docType==="Consumidor Final"?"":"md:grid md:grid-cols-2 md:gap-2"}`,children:[a.duinit==="DUI"?t(C,{required:!0,hidden:a.docType==="Consumidor Final",labeltext:"DUI",value:a.dui,type:"text",name:"dui",autoComplete:"off",onChange:x}):t(C,{required:!0,hidden:a.docType==="Consumidor Final",labeltext:"NIT o NRC",value:a.nrc,type:"text",name:"nrc",autoComplete:"off",onChange:x}),m("div",{className:"flex flex-row",children:[t(C,{required:!0,labeltext:"Proveedor",value:a.supplier,type:"text",name:"supplier",autoComplete:"off",onChange:x,readOnly:a.docType!=="Consumidor Final"}),a.docType!=="Consumidor Final"&&a.supplier===""&&t("button",{type:"button",onClick:()=>u(f=>!f),children:t(ft,{className:"w-6 h-6 m-2 text-gray-500"})})]})]}),m("div",{className:"flex flex-row gap-2",children:[t(C,{required:!0,step:"0.01",labeltext:"Total",value:a.compra,type:"number",min:"0.00",name:"compra",autoComplete:"off",onChange:x}),t(C,{labeltext:"IVA",value:a.iva,type:"number",min:"0",name:"iva",autoComplete:"off",readOnly:!0,onChange:x})]}),t(_t,{title:"M\xE1s campos",hidden:a.docType==="Consumidor Final",children:m("div",{className:"md:grid md:grid-cols-2 gap-x-2",children:[t(C,{labeltext:"Compras internas exentas",value:a.comInEx,type:"number",name:"comInEx",autoComplete:"off",onChange:x}),t(C,{labeltext:"Internaciones exentas y/o no sujetas",value:a.intExNoSuj,type:"number",name:"intExNoSuj",autoComplete:"off",onChange:x}),t(C,{labeltext:"Importaciones exentas y/o no sujetas",value:a.imExNoSuj,type:"number",name:"imExNoSuj",autoComplete:"off",onChange:x}),t(C,{labeltext:"Internaciones gravadas de bienes",value:a.inGraBie,type:"number",name:"inGraBie",autoComplete:"off",onChange:x}),t(C,{labeltext:"Importaciones gravadas de bienes",value:a.imGravBie,type:"number",name:"imGravBie",autoComplete:"off",onChange:x}),t(C,{labeltext:"Importaciones gravadas de servicios",value:a.imGravSer,type:"number",name:"imGravSer",autoComplete:"off",onChange:x})]})}),m("div",{className:"flex flex-row gap-2 w-full",children:[t("button",{className:"button",children:"Agregar a tabla"}),t("button",{type:"button",className:"button",onClick:()=>s({data:r,action:b}),children:"Guardar"}),t("button",{type:"button",className:"button",onClick:()=>h(f=>!f),children:"Ver registros"})]})]}),Array.isArray(r)&&r.length>0&&t(B,{title:"Transacciones",square:!1,data:r,showHeader:Jt,columnsToShow:Vt,withMaxHeight:!0,buttons:[(f,E)=>t("button",{className:"button",onClick:()=>A(E),children:"Borrar"},"delete")]})]})})]})},Q=({children:e,redirectTo:o})=>{const{user:s,state:a}=_e(),n=ve();return console.log(n),a==="loading"?t(G,{}):s?e:t(xt,{to:o,replace:!0,state:{from:n}})},Wt={companies:[],roles:[]},Ge=()=>{const[e,o]=g.exports.useState(Wt),[s,a,n]=P();g.exports.useEffect(()=>{if(s){const d={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:s.token_type+" "+s.access_token}};fetch(Ue,d).then(u=>(n(u.status),u.json())).then(u=>o(u))}},[s]);const l=(d,u)=>{const c={"User saved":function(){p.success("Usuario creado",{id:"userCreated"}),u()},"Email already registered.":function(){p.error("Email ya registrado",{id:"EmailAlreadyRegistered"})},"Company not registered":function(){p.error("Empresa no registrada",{id:"companyNotRegistered"})},"Invalid role":function(){p.error("Rol inv\xE1lido",{id:"invalidRole"})},"Forbidden transaction":function(){p.error("Acci\xF3n no permitida",{id:"forbiddenAction"})},"First name or last name empty":function(){p.error("Nombres o apellidos vacios",{id:"emptyNames"})},"Email empty":function(){p.error("Email vac\xEDo",{id:"emptyEmail"})},default:function(){p.error("Error al guardar usuario",{id:"error"})}};return(c[d]||c.default)()};return[e,async(d,u)=>{const c={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,PATCH,OPTIONS",Authorization:s.token_type+" "+s.access_token},body:JSON.stringify(d)};try{p.loading("Creando usuario...",{id:"userCreation"});const h=await fetch(de,c);n(h.status);const r=await h.json();p.dismiss(),l(r.message,u)}catch(h){p.dismiss(),p.error("Error al crear usuario: "+h)}}]},Qt=({isOpen:e,setIsOpen:o,data:s,toUpdate:a,toDelete:n})=>{const l={active:"Activado",inactive:"Inactivo"},[i,d]=g.exports.useState(s),[u]=Ge(),c=()=>{o(null)},h=y=>{y.preventDefault()},r=y=>{if(y.target.name==="status"){const x={Activo:"active",Inactivo:"inactive"};d(N=>S(w({},N),{statusEn:x[y.target.value]}))}d(x=>S(w({},x),{[y.target.name]:y.target.value}))},b=()=>{a([i]).then(()=>o(null))},v=async()=>{await n([i]),o(null)};return t(ae,{isOpen:e,handleClosingDialog:c,title:"Modificar usuario",children:m("form",{onSubmit:h,children:[t(C,{required:!0,value:i.firstName,labeltext:"Nombres",type:"text",name:"firstName",autoComplete:"off",onChange:r}),t(C,{required:!0,value:i.lastName,labeltext:"Apellidos",type:"text",name:"lastName",autoComplete:"off",onChange:r}),t(k,{value:i.role,name:"role",labeltext:"Rol",onChange:r,data:Object.fromEntries(u.roles.map(y=>[y.roleName,y.id]))}),t(k,{value:l[i.status]||i.status,name:"status",labeltext:"Estado",onChange:r,data:["Activo","Inactivo"]}),m("div",{className:"flex gap-2",children:[t("button",{onClick:()=>b(),className:"button",children:"Actualizar"}),t("button",{onClick:()=>v(),className:"button-warning",children:"Eliminar"})]})]})})},Yt=()=>{const[e,o]=g.exports.useState([]),[s,a]=g.exports.useState([]),[n,l,i]=P();return g.exports.useEffect(()=>{if(n){const d={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET",Authorization:n.token_type+" "+n.access_token}};fetch(At,d).then(u=>(i(u.status),u.json())).then(u=>{o(u)})}},[n]),[e,s,a]},Zt=()=>{const[e,o,s]=P();return[async({data:n,action:l})=>{if(e){const i={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,PATCH,OPTIONS",Authorization:e.token_type+" "+e.access_token},body:JSON.stringify(n)},d=await fetch(Ue,i);s(d.status),(await d.json()).message==="User saved"&&(p.success("Empresa agregada"),l())}}]},Xt={name:"",address:"",phone:"",city:"",state:""},es=({isOpen:e,setIsOpen:o})=>{const[s,a]=g.exports.useState(Xt),[n,l,i]=Yt(),[d]=Zt(),u=()=>{o(r=>!r)},c=r=>{r.preventDefault()},h=r=>{r.target.name==="state"&&i(n[r.target.value]),a(b=>S(w({},b),{[r.target.name]:r.target.value}))};return t(ae,{isOpen:e,handleClosingDialog:u,title:"Crear negocio",children:m("form",{onSubmit:c,children:[t(C,{required:!0,value:s.name,labeltext:"Nombre",type:"text",name:"name",autoComplete:"off",onChange:h}),t(C,{required:!0,value:s.address,labeltext:"Direcci\xF3n",type:"text",name:"address",autoComplete:"off",onChange:h}),t(C,{required:!0,value:s.phone,labeltext:"Tel\xE9fono",type:"text",name:"phone",autoComplete:"off",onChange:h}),t(k,{data:Object.keys(n),value:s.state,name:"state",labeltext:"Departamento",onChange:h}),t(k,{data:l,value:s.city,name:"city",labeltext:"Municipio",onChange:h}),t("button",{className:"button",onClick:()=>d({data:[s],action:u}),children:"Crear empresa"})]})})},ts=[],Pe={email:"",firstName:"",lastName:"",businessName:"",businessState:"",businessCity:"",businessAddress:"",role:"",uuid:""},ss=({isOpen:e,setIsOpen:o})=>{const[s,a]=Ge(),[n,l]=g.exports.useState(Pe);console.log(n);const[i,d]=g.exports.useState(ts),u=r=>{if(r.target.name==="businessState"){const b=s.companies.filter(v=>r.target.value===v.state);d(b),l(v=>S(w({},n),{businessState:r.target.value}))}if(r.target.name==="businessCity"){const b=s.companies.filter(v=>r.target.value===v.city);d(b)}if(r.target.name==="businessName"){const b=s.companies.filter(v=>r.target.value===v.name);d(b)}r.target.name==="businessAddress"&&l(b=>S(w({},b),{uuid:i[0].uuid})),l(b=>S(w({},b),{[r.target.name]:r.target.value}))},c=()=>{o(r=>!r),l(Pe)};return t(ae,{isOpen:e,handleClosingDialog:c,title:"Crear usuario",children:m("form",{onSubmit:r=>{r.preventDefault(),a([{email:n.email,firstName:n.firstName,lastName:n.lastName,role:n.role,uuid:n.uuid}],c)},children:[t(C,{required:!0,value:n.email,labeltext:"Email",type:"email",name:"email",autoComplete:"off",onChange:u}),t(C,{required:!0,value:n.firstName,labeltext:"Nombres",type:"text",name:"firstName",autoComplete:"off",onChange:u}),t(C,{required:!0,value:n.lastName,labeltext:"Apellidos",type:"text",name:"lastName",autoComplete:"off",onChange:u}),t(k,{value:n.role,name:"role",labeltext:"Rol",onChange:u,data:Object.fromEntries(s.roles.map(r=>[r.roleName,r.id]))}),t(k,{value:n.businessState,name:"businessState",labeltext:"Departamento",onChange:u,data:Object.fromEntries(s.companies.map(r=>[r.state,r.id]))}),n.businessState!==""&&t(k,{value:n.businessCity,name:"businessCity",labeltext:"Ciudad",onChange:u,data:Object.fromEntries(i.map(r=>[r.city,r.id]))}),n.businessCity!==""&&t(k,{value:n.businessName,name:"businessName",labeltext:"Negocio",onChange:u,data:Object.fromEntries(i.map(r=>[r.name,r.id]))}),n.businessName!==""&&t(k,{value:n.businessAddress,name:"businessAddress",labeltext:"Direcci\xF3n",onChange:u,data:Object.fromEntries(i.map(r=>[r.address,r.uuid]))}),t("button",{className:"button",children:"Crear usuario"})]})})},as=()=>{const[e,o]=g.exports.useState([]),[s,a,n]=P(),l=async()=>{const u={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:s.token_type+" "+s.access_token}};fetch(de,u).then(c=>(n(c.status),c.json())).then(c=>{let h=[];for(let r of c){let b=S(w({},r),{action:t("button",{children:"sa"})});h.push(b)}o(h)})};return g.exports.useEffect(()=>{s&&l()},[s]),[e,async u=>{const c={method:"PATCH",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,PATCH",Authorization:s.token_type+" "+s.access_token},body:JSON.stringify(u)};p.loading("Modificando usuario...");try{const h=await fetch(de,c);n(h.status);const r=await h.json();if(h.status!==200)throw new Error(r.detail);return p.dismiss(),p.success("Usuario actualizado"),l(),r}catch(h){return p.dismiss(),p.error("Error al actualizar usuario: "+h),h}},async u=>{const c={method:"DELETE",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET,PATCH",Authorization:s.token_type+" "+s.access_token},body:JSON.stringify(u)};p.loading("Eliminando usuario...");try{const h=await fetch(de,c);n(h.status);const r=await h.json();if(h.status!==200)throw new Error(r.detail);return p.dismiss(),p.success("Usuario eliminado"),l(),r}catch(h){return p.dismiss(),p.error("Error al eliminar usuario: "+h),h}}]},os=["Email","Rol","Nombre","Apellido","Negocio","Departamento","Municipio","Direcci\xF3n","Status","actions"],ns=["email","role","firstName","lastName","business","state","city","address","status"],rs=()=>{const[e,o,s]=as(),[a,n]=g.exports.useState(!1),[l,i]=g.exports.useState(!1),[d,u]=g.exports.useState(null);return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),a&&t(ss,{isOpen:a,setIsOpen:n}),l&&t(es,{isOpen:l,setIsOpen:i}),d&&t(Qt,{isOpen:!!d,setIsOpen:u,data:d,toUpdate:o,toDelete:s}),t("div",{className:"w-full lg:pl-60",children:m("div",{className:"relative flex flex-col justify-end mt-12 lg:mt-0",children:[m("div",{className:"flex flex-row mx-1 my-2 justify-between",children:[m("h2",{className:"m-2",children:["Cantidad de registros: ",e.length]}),m("div",{className:"flex",children:[t("div",{className:"w-32 mx-1",children:t("button",{type:"button",onClick:()=>n(c=>!c),className:"button",children:"Crear usuario"})}),t("div",{className:"w-32 mx-1",children:t("button",{type:"button",className:"button",onClick:()=>i(c=>!c),children:"Crear negocio"})})]})]}),Array.isArray(e)&&e.length>0&&t(B,{title:"Registros",buttons:[c=>t("button",{className:"button",onClick:()=>u(c),children:"Editar"},"edit")],square:!1,data:e,showHeader:os,columnsToShow:ns,withMaxHeight:!0})]})})]})},is=(e,o)=>`${xe}?start=${e}&finish=${o}`,Be=()=>{const[e,o]=g.exports.useState([]),[s,a,n]=P();return{addExpenses:async({data:u,action:c})=>{if(u.length>0){const h={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a},body:JSON.stringify(u)};try{const r=p.loading("Guardando gastos...",{id:"addingExpenses"}),b=await fetch(xe,h);n(b.status);const v=await b.json();p.dismiss(r),v>0&&(p.success("Gastos guardadas",{id:"expenses"}),c([]),localStorage.setItem("gastos",JSON.stringify([])))}catch(r){p.dismiss(),p.error("Error al guardar gastos: "+r,{id:"expensesError"})}}else p.error("No hay gastos que guardar",{id:"expensesError"})},expenses:e,getExpenses:async({start:u,end:c})=>{const h=R(u),r=R(c),b={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};try{const v=p.loading("Cargando...",{id:"loading"}),y=await fetch(is(h,r),b);n(y.status);const x=await y.json();p.dismiss(v),o(x)}catch(v){p.dismiss(),p.error("Error al obtener registros: "+v)}},deleteExpenses:async({id:u})=>{let c=xe+"?gastosId="+u;const h={method:"DELETE",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"DELETE",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};try{const r=p.loading("Borrando...",{id:"deleting"}),b=await fetch(c,h);n(b.status);const v=await b.json();p.dismiss(r),v>0&&p.success("Registro eliminado",{id:"deleted"})}catch(r){p.dismiss(),p.error("Error al eliminar registro: "+r)}}}};re("es",ie);const ls=["Fecha","Categor\xEDa","Monto","Descripci\xF3n","Acciones"],cs=["fecha","tipo","monto","descripcion"],us=()=>{const{expenses:e,getExpenses:o,deleteExpenses:s}=Be(),[a,n]=g.exports.useState([new Date,new Date]),[l,i]=a,d=g.exports.useRef(),u=async c=>{await s({id:c}),await o({start:l,end:i})};return m(G,{children:[m("div",{className:"relative flex justify-end mr-2",children:[t("div",{className:"w-60",children:t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:d,labeltext:"Fecha"}),selectsRange:!0,peekNextMonth:!0,showMonthDropdown:!0,useShortMonthInDropdown:!0,startDate:l,endDate:i,onChange:c=>{n(c)}})}),t(le,{onClick:()=>o({start:l,end:i})})]}),t(B,{title:"Lista de gastos",square:!1,data:e,showHeader:ls,columnsToShow:cs,activateActions:!0,buttons:[(c,h,r)=>t("button",{className:"button-warning",onClick:()=>u(r),children:"Borrar"},r)]})]})},ds={categorie:"Salario",amount:"",details:""},ps=["Salario","Impuesto","Servicio","Mantenimiento","Alquiler","Publicidad","Comisi\xF3n","ISSS","Propina","Otro"],ms=["Fecha","Categor\xEDa","Monto","Descripci\xF3n","Acciones"],hs=["fecha","tipo","monto","descripcion"],gs=()=>{var v;const[e,o]=g.exports.useState(ds),[s,a]=g.exports.useState(!1),[n,l]=g.exports.useState(new Date),[i,d]=g.exports.useState(JSON.parse((v=localStorage.getItem("gastos"))!=null?v:"[]")),u=g.exports.useRef(),{addExpenses:c}=Be(),h=y=>{o(x=>S(w({},x),{[y.target.name]:y.target.value}))},r=y=>{y.preventDefault();const{categorie:x,amount:N,details:A}=e;let D={id:0,fecha:R(n),tipo:x,monto:N,descripcion:A,guardado:new Date().toISOString()};d(f=>[...f,D]),localStorage.setItem("gastos",JSON.stringify([...i,D])),o(f=>S(w({},f),{amount:"",details:""}))},b=y=>{const x=i.filter((N,A)=>A!==y);d(x),localStorage.setItem("gastos",JSON.stringify(x))};return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),t(ae,{fullScreen:!0,isOpen:s,handleClosingDialog:()=>a(y=>!y),children:t(us,{})}),t("div",{className:"w-full lg:pl-60",children:m("div",{className:"relative flex flex-col mx-2 mt-12 lg:mt-0",children:[m("form",{onSubmit:r,children:[m("div",{className:"md:flex md:gap-2",children:[t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:u,labeltext:"Fecha"}),selected:n,peekNextMonth:!0,useShortMonthInDropdown:!0,onChange:y=>{l(y)}}),t(k,{value:e.categorie,name:"categorie",onChange:h,data:ps})]}),m("div",{className:"md:flex md:gap-2",children:[t(C,{required:!0,step:"0.01",labeltext:"Monto",value:e.amount,type:"number",min:"0.00",name:"amount",autoComplete:"off",onChange:h}),t(C,{required:!0,labeltext:"Descripci\xF3n",value:e.details,type:"text",name:"details",autoComplete:"off",onChange:h})]}),m("div",{className:"flex flex-row gap-2 w-full",children:[t("button",{className:"button",children:"Agregar a tabla"}),t("button",{type:"button",className:"button",onClick:()=>c({data:i,action:d}),children:"Guardar"}),t("button",{type:"button",className:"button",onClick:()=>a(y=>!y),children:"Ver registros"})]})]}),Array.isArray(i)&&i.length>0&&t(B,{title:"Transacciones",square:!1,data:i,showHeader:ms,columnsToShow:hs,withMaxHeight:!0,buttons:[(y,x)=>t("button",{className:"button",onClick:()=>b(x),children:"Borrar"},"delete")]})]})})]})},$e=({children:e,title:o})=>m("div",{className:"border rounded-lg shadow-sm bg-white p-2 my-2 max-w-2xl w-full",children:[t("h3",{children:o}),e]}),fs=()=>{const[e,o,s]=P(),[a,n]=g.exports.useState({appId:"",appKey:""});console.log(a);const l={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(e==null?void 0:e.token_type)+" "+(e==null?void 0:e.access_token),uuid:o}};return g.exports.useEffect(()=>{if(e){p.loading("Cargando...");try{fetch(Ot,l).then(i=>(s(i.status),i.json())).then(i=>n(i))}catch{p.dismiss(),p.error("No se obtuvieron credenciales de app")}p.dismiss()}},[e]),[a,o]},xs=()=>{const[e,o]=fs();return m($e,{title:"Credenciales API",children:[t(C,{labeltext:"App Id",value:e.appId,readOnly:!0}),t(C,{labeltext:"App Key",value:e.appKey,readOnly:!0}),t(C,{labeltext:"UUID",value:o,readOnly:!0})]})},bs=()=>{const[e,o,s]=P();return{changePassword:async({data:n})=>{console.log(n);const l={method:"POST",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST",Authorization:e.token_type+" "+e.access_token},body:JSON.stringify(n)};p.loading("Cambiando contrase\xF1a...");try{const i=await fetch(Et,l),d=await i.json();if(i.status!==200)throw new Error(d.detail);return p.dismiss(),p.success("Contrase\xF1a actualizada"),d}catch(i){return p.dismiss(),p.error("Error al actualizar contrase\xF1a: "+i),i}}}},Me={password:"",newpassword:"",passwordconfirm:""},ys=()=>{const[e,o]=g.exports.useState(Me),{changePassword:s}=bs(),a=l=>{o(i=>S(w({},i),{[l.target.name]:l.target.value}))};return t($e,{title:"Cambiar contrase\xF1a",children:t("form",{onSubmit:l=>{l.preventDefault(),s({data:e}),o(Me),console.log(e)},children:t("div",{className:"flex flex-col items-center justify-center",children:m("div",{className:"w-full p-4",children:[t(C,{required:!0,labeltext:"Contrase\xF1a actual",value:e.password,type:"password",name:"password",autoComplete:"off",onChange:a}),t(C,{required:!0,labeltext:"Contrase\xF1a nueva",value:e.newpassword,type:"password",name:"newpassword",autoComplete:"off",onChange:a}),t(C,{required:!0,labeltext:"Confirmaci\xF3n de contrase\xF1a",value:e.passwordconfirm,type:"password",name:"passwordconfirm",autoComplete:"off",onChange:a}),t("button",{className:"button",children:"Cambiar contrase\xF1a"})]})})})})},vs=()=>m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),t("div",{className:"w-full lg:pl-60",children:m("div",{className:"relative flex flex-col mx-2 mt-12 lg:mt-0 items-center justify-center",children:[t(ys,{}),t(xs,{})]})})]}),Cs=({children:e})=>t("table",{className:"table border-separate box-border w-5/6 max-w-lg",children:t("tbody",{className:"table-row-group align-middle",children:e})}),ws=({business:e,period:o,title:s})=>t("tr",{children:t("td",{colSpan:2,className:"text-black table-cell text-center",children:m("b",{children:[t("h2",{children:e}),t("h2",{children:s}),t("h2",{children:o})]})})}),O=({isHeader:e=!1,title:o,value:s,isTotal:a=!1})=>t(G,{children:e?t("tr",{className:" bg-gray-300 indent-1",children:a?m(G,{children:[t("td",{className:"table-cell",children:t("b",{children:o})}),t("td",{className:"table-cell ",children:t("b",{children:t("p",{className:"text-right",children:s})})})]}):t("td",{colSpan:2,className:" table-cell",children:t("b",{children:o})})}):m("tr",{className:"bg-gray-100  indent-3 ",children:[t("td",{children:t("p",{children:o})}),t("td",{children:t("p",{className:"text-right",children:s})})]})}),Le=(e,o)=>`${Tt}?start=${e}&finish=${o}`,Ns={gastos:{Servicio:0,Alquiler:0,Salario:0,Propina:0,ISSS:0,Publicidad:0,Mantenimiento:0,Comisi\u00F3n:0,Otro:0},compras:{compraTotal:0,compraDeducible:0},tickets:{total:0,propina:0},iva:{total:0,deducible:0}},Ss=()=>{const[e,o]=g.exports.useState(Ns),[s,a,n]=P(),l={method:"GET",headers:{"Content-Type":"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"POST,GET",Authorization:(s==null?void 0:s.token_type)+" "+(s==null?void 0:s.access_token),uuid:a}};return g.exports.useEffect(()=>{if(s){p.loading("Cargando...");try{fetch(Le(R(Date.now()),R(Date.now())),l).then(d=>(n(d.status),d.json())).then(d=>o(d)),p.dismiss()}catch{p.dismiss(),p.error("Error al cargar reporte")}}},[s]),[e,async({start:d,finish:u})=>{p.loading("Cargando...");try{const h=await(await fetch(Le(R(d),R(u)),l)).json();o(h),p.dismiss()}catch{p.dismiss(),p.error("Error al cargar reporte")}}]};re("es",ie);const As=()=>{var c,h,r,b,v,y,x,N,A,D,f,E,I,F,M,oe,ne;const[e,o]=Ss(),[s,a]=g.exports.useState([new Date,new Date]),[n,l]=s,i=g.exports.useRef(),d=()=>{var $,H,z,J,V,K,W,ee,me,te,se,we,Ne,Se;const L=(($=e==null?void 0:e.tickets)==null?void 0:$.total)-((H=e==null?void 0:e.compras)==null?void 0:H.compraTotal)-((z=e==null?void 0:e.gastos)==null?void 0:z.Salario)-((J=e==null?void 0:e.gastos)==null?void 0:J.Propina)-((V=e==null?void 0:e.tickets)==null?void 0:V.propina)-((K=e==null?void 0:e.gastos)==null?void 0:K.ISSS)-((W=e==null?void 0:e.gastos)==null?void 0:W.Mantenimiento)-((ee=e==null?void 0:e.gastos)==null?void 0:ee.Publicidad)-((me=e==null?void 0:e.gastos)==null?void 0:me.Alquiler)-((te=e==null?void 0:e.gastos)==null?void 0:te.Servicio)-((se=e==null?void 0:e.gastos)==null?void 0:se.Comisi\u00F3n)-((we=e==null?void 0:e.iva)==null?void 0:we.total)+((Ne=e==null?void 0:e.iva)==null?void 0:Ne.deducible)-((Se=e==null?void 0:e.gastos)==null?void 0:Se.Otro);return T(L,2)},u=()=>{var $,H,z,J,V,K,W,ee;const L=(($=e==null?void 0:e.gastos)==null?void 0:$.Mantenimiento)+((H=e==null?void 0:e.gastos)==null?void 0:H.Publicidad)+((z=e==null?void 0:e.gastos)==null?void 0:z.Alquiler)+((J=e==null?void 0:e.gastos)==null?void 0:J.Servicio)+((V=e==null?void 0:e.gastos)==null?void 0:V.Comisi\u00F3n)+((K=e==null?void 0:e.iva)==null?void 0:K.total)-((W=e==null?void 0:e.iva)==null?void 0:W.deducible)+((ee=e==null?void 0:e.gastos)==null?void 0:ee.Otro);return T(L,2)};return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),t("div",{className:"w-full lg:pl-60",children:m("div",{className:"flex  flex-col  mx-2 mt-12 lg:mt-0",children:[m("div",{className:"relative flex justify-end mr-2",children:[t("div",{className:"w-60",children:t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:i,labeltext:"Fecha"}),selectsRange:!0,peekNextMonth:!0,showMonthDropdown:!0,useShortMonthInDropdown:!0,startDate:n,endDate:l,onChange:L=>{a(L)}})}),t(le,{onClick:()=>o({start:n,finish:l})})]}),t("div",{className:"flex justify-center items-center ",children:m(Cs,{children:[t(ws,{business:"",period:"",title:"Ganancias y p\xE9rdidas"}),t(O,{isHeader:!0,title:"Ingresos"}),t(O,{title:"Ventas",value:T((c=e==null?void 0:e.tickets)==null?void 0:c.total,2)}),t(O,{isHeader:!0,title:"Costos"}),t(O,{title:"Compras",value:T((h=e==null?void 0:e.compras)==null?void 0:h.compraTotal,2)}),t(O,{isHeader:!0,title:"Coste laboral"}),t(O,{title:"Salario",value:T((r=e==null?void 0:e.gastos)==null?void 0:r.Salario,2)}),t(O,{title:"Propina",value:T(((b=e==null?void 0:e.gastos)==null?void 0:b.Propina)+((v=e==null?void 0:e.tickets)==null?void 0:v.propina),2)}),t(O,{title:"Seguro",value:T((y=e==null?void 0:e.gastos)==null?void 0:y.ISSS,2)}),t(O,{title:"Subtotal",value:T(((x=e==null?void 0:e.gastos)==null?void 0:x.Salario)+((N=e==null?void 0:e.gastos)==null?void 0:N.Propina)+((A=e==null?void 0:e.gastos)==null?void 0:A.ISSS),2)}),t(O,{isHeader:!0,title:"Costo de operaci\xF3n"}),t(O,{title:"Mantenimientos",value:T((D=e==null?void 0:e.gastos)==null?void 0:D.Mantenimiento,2)}),t(O,{title:"Publicidad",value:T((f=e==null?void 0:e.gastos)==null?void 0:f.Publicidad,2)}),t(O,{title:"Alquiler",value:T((E=e==null?void 0:e.gastos)==null?void 0:E.Alquiler,2)}),t(O,{title:"Servicios",value:T((I=e==null?void 0:e.gastos)==null?void 0:I.Servicio,2)}),t(O,{title:"Comisiones",value:T((F=e==null?void 0:e.gastos)==null?void 0:F.Comisi\u00F3n,2)}),t(O,{title:"Impuestos",value:T((M=e==null?void 0:e.iva)==null?void 0:M.total,2)}),t(O,{title:"Impuestos deducibles",value:T((oe=e==null?void 0:e.iva)==null?void 0:oe.deducible,2)}),t(O,{title:"Otro",value:T((ne=e==null?void 0:e.gastos)==null?void 0:ne.Otro,2)}),t(O,{title:"Subtotal",value:u()}),t(O,{isHeader:!0,isTotal:!0,title:"Utilidad neta",value:d()})]})})]})})]})};re("es",ie);const Ds=["Fecha","Documento","Tipo","Descripci\xF3n/Referencia","NRC","Proveedor","Total","IVA","DUI","Compras internas exentas","Internaciones exentas y/o no sujetas","importaciones exentas y/o no sujetas","Internaciones gravadas de bienes","Importaciones gravadas de bienes","Importaciones gravadas de servicios"],Es=["fecha","documento","tipo","referencia","nrc","nombre","compra","iva","dui","comInEx","intExNoSuj","imExNoSuj","inGraBie","imGravBie","imGravSer"],Os=()=>{const[e,o]=g.exports.useState([new Date,new Date]),[s,a]=e,n=g.exports.useRef(),{getPurchases:l,filters:i,filterData:d,filteredData:u}=Ce();return m("div",{className:"h-screen flex flex-row bg-blue-200 bg-opacity-10",children:[t(X,{}),t("div",{className:"w-full mb-12 lg:pl-60",children:m("div",{className:"flex flex-col mx-2 mt-12 lg:mt-0 h-full",children:[m("div",{className:"relative flex justify-end mr-2",children:[t("div",{className:"w-60",children:t(Y,{locale:"es",todayButton:"Hoy",customInput:t(Z,{ref:n,labeltext:"Fecha"}),selectsRange:!0,peekNextMonth:!0,showMonthDropdown:!0,useShortMonthInDropdown:!0,startDate:s,endDate:a,onChange:c=>{o(c)}})}),t(le,{onClick:()=>l({start:s,end:a})})]}),m("div",{className:"mx-2 flex flex-col gap-2",children:[t(Te,{options:i.doc,isMulti:!0,onChange:c=>d(c,"doc")}),t(Te,{options:i.type,isMulti:!0,onChange:c=>d(c,"type")})]}),t("div",{className:"max-h-[75%]",children:t(B,{title:"Lista de compras",square:!1,data:u,showHeader:Ds,columnsToShow:Es,activateActions:!0,withMaxHeight:!0})})]})})]})};function Ts(){return m(G,{children:[t(bt,{}),m(yt,{children:[t(U,{path:"/login",element:t(qt,{})}),t(U,{path:"/",element:t(Q,{redirectTo:"/login",children:t(Ut,{})})}),t(U,{path:"/usuarios",element:t(Q,{redirectTo:"/login",children:t(rs,{})})}),t(U,{path:"/compras",element:t(Q,{redirectTo:"/login",children:t(Kt,{})})}),t(U,{path:"/gastos",element:t(Q,{redirectTo:"/login",children:t(gs,{})})}),t(U,{path:"/ajustes",element:t(Q,{redirectTo:"/login",children:t(vs,{})})}),t(U,{path:"/reporte/ganancias",element:t(Q,{redirectTo:"/login",children:t(As,{})})}),t(U,{path:"/reporte/compras",element:t(Q,{redirectTo:"/login",children:t(Os,{})})})]})]})}vt.render(t(ye.StrictMode,{children:t(Ct,{children:t(Ts,{})})}),document.getElementById("root"));
